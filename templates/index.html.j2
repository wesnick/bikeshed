<!DOCTYPE html>
<html lang="en" data-theme="light">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>
      {% block title %}BikeShed Dashboard{% endblock %}
    </title>
    <link rel="icon" href="/build/favicon.ico" sizes="any">
    <link rel="stylesheet" href="/build/css/app.css">
    <link rel="stylesheet"
          href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css"
          integrity="sha512-Evv84Mr4kqVGRNSgIGL/F/aIDqQb7xQ2vcrdIwxfjThSH8CSR7PBEakCr51Ck+w+/U6swU2Im1vVX0SVk9ABhg=="
          crossorigin="anonymous"
          referrerpolicy="no-referrer" />
    <script type="module" src="/build/js/app.js" defer></script>
    {% block head %}{% endblock %}
  </head>
  <body hx-ext="sse"
        sse-connect="/sse"
        sse-close="server_shutdown"
        class="overflow-hidden">
    <div class="dashboard-container">
      <!-- Header Section -->
      <header class="header">
        <nav class="navbar navbar-expand-lg shadow"
             role="navigation"
             aria-label="main navigation">
          <div class="container-fluid">
            <a class="navbar-brand fw-bold fs-4" href="/">
              {% block branding %}BikeShed{% endblock %}
            </a>
            <span class="ms-2"><i class="fas fa-2x fa-bicycle"></i></span>

            <!-- Navbar items container -->
            <div class="collapse navbar-collapse">
              <div class="navbar-nav me-auto">
                <div class="nav-item"
                     hx-get="/root-selector"
                     hx-trigger="load, sse:root.selected, sse:root.updated">
                  <button class="btn btn-sm btn-outline-secondary">
                    <span class="icon"><i class="fas fa-folder"></i></span>
                    <span>Select Root</span>
                  </button>
                </div>
                <!-- Notification Section -->
                <div id="notification-area" class="nav-item"></div>
              </div>

              <div class="navbar-nav ms-auto">
                <div class="nav-item"
                     hx-get="/components/navbar-notifications"
                     hx-trigger="load, sse:dialog_update, sse:notifications.update">
                  {% include 'components/skeleton.html.j2' %}
                </div>
                <div class="nav-item">
                  <a class="theme-toggle nav-link" href="#">
                    <span class="icon"><i class="fas fa-moon"></i></span>
                    <span class="theme-text">Light Mode</span>
                  </a>
                </div>
              </div>
            </div>
          </div>
        </nav>
      </header>
      <!-- Left Sidebar -->
      <aside class="sidebar p-2 d-flex flex-column">
        <div class="sidebar-navigation overflow-y-auto"
             hx-get="/components/left-sidebar"
             hx-trigger="load">{% include 'components/skeleton.html.j2' %}</div>
        <div class="sidebar-settings mt-auto"
             hx-get="/registry"
             hx-trigger="load, sse:registry.updated from:body"></div>
      </aside>
      <!-- Main Dash -->
      <main class="dashboard pt-2 px-2 d-flex flex-column overflow-y-auto overflow-x-hidden">
      </main>
      <!-- Drawer -->
      <aside class="drawer-container p-2">
        <div class="drawer"
             hx-get="/components/drawer"
             hx-trigger="load, route.updated from:body">{% include 'components/skeleton.html.j2' %}</div>
      </aside>
    </div>
    <!-- Modal Container -->
    <div class="modal fade" id="modal-container" tabindex="-1" aria-labelledby="modal-title-placeholder" aria-hidden="true">
      <div class="modal-dialog modal-xl"> <!-- modal-dialog-scrollable can be added if needed -->
        <div class="modal-content">
          <!-- HTMX will load modal content here -->
          <!-- Example structure for loaded content:
          <div class="modal-header">
            <h5 class="modal-title" id="modal-title-placeholder">Modal title</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            ...
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
            <button type="button" class="btn btn-primary">Save changes</button>
          </div>
          -->
        </div>
      </div>
    </div>
  </body>
</html>
